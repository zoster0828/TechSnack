# 웹 서버 비즈니스 프로젝트의 애자일 테스팅 피라미드

이 문서는 웹 서버 비즈니스 프로젝트에서 **애자일 테스팅 피라미드**를 적용한 테스트 전략과 실제 진행 과정을 간략히 정리한 것입니다. **외부 핵심 도메인**(이전 “모델” 또는 ML/AI 서버) 및 **외부 도메인**(이전 “OB”) 팀과의 협업, 1차와 2차 Shadow Test 일정을 포함한 간트차트 예시를 담았습니다.

---

## 1. 애자일 테스팅 피라미드 개요

1. **유닛(Unit) 테스트**
    - **가장 아래층**: 클래스·함수 등 작은 단위 로직을 빠르게 검증
    - Mock/Stub으로 외부 의존 최소화, 코드 커버리지(예: 95% 이상) 목표

2. **통합(Integration) 테스트**
    - **중간층**: DB, 외부 API, 서드파티 라이브러리 등과 실제 연동 검증
    - 데이터 흐름·인터페이스 정합성 중점 확인

3. **엔드 투 엔드(End-to-End) / 인수(Acceptance) 테스트**
    - **최상단**: 사용자 시나리오 전체를 검증
    - UI, 비즈니스 로직, 외부 서비스 연동이 문제없이 동작하는지 확인

---

## 2. 테스트 수행 과정 및 순서

### 2.1 개발 & 유닛 테스트
- 기능 개발 직후, 클래스·메서드 단위의 유닛 테스트 작성
- 로직 오류 조기 발견, 리팩토링 안정성 확보

### 2.2 외부 핵심 도메인 연동 & 1차 Shadow Test
- 외부 핵심 도메인(ML/AI, 이전 “모델”)과의 최소 통신 코드를 구현
- **1차 Shadow Test**: 운영 트래픽을 복제하여 외부 핵심 도메인의 기능·성능을 별도 Shadow 환경에서 사전 검증
- 외부 핵심 도메인 팀이 발견된 문제를 운영 영향 없이 수정

### 2.3 Use Case BDD & 어댑터(외부 도메인) 통합 테스트
- **Use Case BDD**: “Given-When-Then” 방식으로 주요 비즈니스 로직 검증
- **어댑터 통합**:
    - DB, 외부 API(외부 핵심 도메인 포함) 연동 확인
    - 특히 **외부 도메인** 팀과의 인터페이스(요청/응답 포맷, 인증 방식) 정합성 조기 확인
    - 호환성 오류를 사전에 발견·해결

### 2.4 프론트엔드 목킹 기반 E2E
- 실제 프론트엔드 개발 전/병행으로, 목킹된 UI를 통해 API 호출 흐름 검증
- 데이터 포맷 혹은 인터페이스 불일치를 빠르게 찾아 수정

### 2.5 최종 프론트엔드 통합 & Visualization
- 목킹을 제거하고 실제 프론트엔드 코드로 전체 E2E 시나리오 진행
- **Visualization**: 외부 핵심 도메인(ML/AI)에서 받은 데이터를 UI에 시각화, 기능·UX 개선점을 피드백
- **외부 도메인** 연동도 실제 사용자 흐름에서 최종 점검 후 버그 수정

### 2.6 2차 Shadow Test (최종 검증)
- 모든 기능을 통합한 뒤, **2차 Shadow Test**로 최종 성능·안정성을 확인
- 다시 한번 운영 트래픽을 복제하여 외부 핵심 도메인, 외부 도메인과의 연동에 문제가 없는지 확인
- 배포 직전에 발생할 수 있는 성능 병목이나 예외 상황을 사전에 해결

---

## 3. 간트차트 예시

| **작업**                                                 | W1  | W2  | W3  | W4  | W5  | W6  | W7  |
|---------------------------------------------------------|:--: |:--: |:--: |:--: |:--: |:--: |:--: |
| **1. 개발 & 유닛 테스트**                               | ■■  | ■■  |     |     |     |     |     |
| **2. 외부 핵심 도메인 연동 & 1차 Shadow Test**          |     | ■■  | ■■  |     |     |     |     |
| **3. Use Case BDD & 어댑터(외부 도메인) 통합 테스트**    |     |     | ■■  | ■■  | ■■  |     |     |
| **4. 프론트엔드 목킹 기반 E2E 테스트**                  |     |     |     | ■■  | ■■  |     |     |
| **5. 최종 프론트엔드 통합 & Visualization**             |     |     |     |     | ■■  | ■■  |     |
| **6. 2차 Shadow Test (최종 검증)**                      |     |     |     |     |     | ■■  | ■■  |

> **■**는 해당 작업이 진행되는 기간을 의미합니다.

---

## 4. 이점

1. **계층적·점진적 테스트**
    - 유닛, 통합, E2E, 그리고 1·2차 Shadow Test로 오류를 단계별로 조기에 발견
2. **협업 강화**
    - **외부 핵심 도메인**: Shadow Test(실제 트래픽 복제)로 성능·기능 이슈를 선제적으로 해결
    - **외부 도메인**: 어댑터 통합 테스트로 포맷·인증 문제를 사전에 조율
3. **프론트엔드-백엔드 병행 개발 효율화**
    - 목킹 UI로 초기 단계부터 불일치 해결, 대규모 리팩토링 최소화
4. **운영 안정성 확보**
    - 2단계 Shadow Testing을 통해 운영 배포 전 최종 문제 점검
    - 실제 환경에 준하는 테스트로 장애 가능성 감소

---

## 5. 결론 및 향후 과제
- **자동화**: 유닛, 통합, E2E, Shadow(1·2차) 테스트를 모두 CI/CD 파이프라인에 통합
- **컨트랙트 테스트**(예: Pact) 도입 검토: 외부 도메인의 API 변경 시 호환성 보장
- **지속적 협업**: 외부 핵심 도메인·외부 도메인·프론트엔드·백엔드 팀 간 테스트 스펙을 투명하게 공유·관리

이처럼 **애자일 테스팅 피라미드**에 **1·2차 Shadow Test**, **프론트엔드 목킹**을 결합함으로써 개발 초기부터 배포 직전까지 전 과정에서 **고품질**과 **신속한 피드백**을 실현할 수 있으며, 궁극적으로 **안정적인 서비스 운영**과 **개발 효율성**을 동시에 달성할 수 있습니다.
